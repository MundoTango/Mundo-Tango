VISUAL EDITOR + MR. BLUE - COMPLETE FEATURES & INTELLIGENCE HANDOFF
Branch: 10-21-2025
Methodology: MB.MD (Simultaneously, Recursively, Critically)
Date: November 3, 2025
Purpose: Complete zero-knowledge handoff of ALL Visual Editor and Mr. Blue features

ðŸŽ¯ EXECUTIVE SUMMARY
This document contains EVERYTHING you need to know about the Visual Editor (Agent #78) and Mr. Blue Intelligence System (Agents #73-80) built in the 10-21-2025 branch.

What This System Does
Visual Editor: Figma-like page editing tool that lets Super Admins modify any page without writing code. Click elements to select them, drag to reposition, edit properties, and let AI generate production-ready React/Tailwind code.

Mr. Blue: Context-aware AI companion (like Replit Agent) that understands what page you're on, tracks recent actions, monitors for errors, and helps you edit conversationally through chat.

Together: You can chat with Mr. Blue to edit pages ("make this button bigger") and Mr. Blue orchestrates the Visual Editor + AI code generation + Git deployment workflow.

ðŸ“Š TABLE OF CONTENTS
Visual Editor Features
Mr. Blue Intelligence System
Integration & Workflows
Technical Implementation
Database Schema
API Endpoints
Security & Access Control
File Structure
1. VISUAL EDITOR FEATURES
1.1 Overview
The Visual Editor is a Replit-style visual page editing system that enables Super Admins to modify any page without writing code.

Access: Add ?edit=true to any page URL

Example: /memories?edit=true
Example: /groups?edit=true
Example: /profile/username?edit=true
1.2 Core Features
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  VISUAL EDITOR CAPABILITIES                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                            â•‘
â•‘  âœ… Click-to-Select Any Element                            â•‘
â•‘     â””â”€ Click any element with data-testid to select       â•‘
â•‘     â””â”€ Purple outline on hover                            â•‘
â•‘     â””â”€ Solid purple border when selected                  â•‘
â•‘     â””â”€ Element inspector shows component details          â•‘
â•‘                                                            â•‘
â•‘  âœ… Drag & Drop Repositioning (Figma-like)                 â•‘
â•‘     â””â”€ Drag selected elements to new positions            â•‘
â•‘     â””â”€ Real-time position tracking                        â•‘
â•‘     â””â”€ Alignment guides & snap-to-grid                    â•‘
â•‘     â””â”€ No manual X/Y coordinates needed                   â•‘
â•‘                                                            â•‘
â•‘  âœ… Edit Controls (4 Tabs)                                 â•‘
â•‘     â”œâ”€ Position Tab: X, Y, alignment (center, left, right)â•‘
â•‘     â”œâ”€ Size Tab: Width, height, aspect ratio lock         â•‘
â•‘     â”œâ”€ Style Tab: Colors, fonts, borders, shadows         â•‘
â•‘     â””â”€ Text Tab: Content, alignment, line height          â•‘
â•‘                                                            â•‘
â•‘  âœ… AI Code Generation (OpenAI GPT-4o)                     â•‘
â•‘     â””â”€ Converts visual changes â†’ React/Tailwind code      â•‘
â•‘     â””â”€ Shows before/after code diff                       â•‘
â•‘     â””â”€ Explains what changed                              â•‘
â•‘     â””â”€ Identifies affected files                          â•‘
â•‘                                                            â•‘
â•‘  âœ… Git Automation Workflow                                â•‘
â•‘     â””â”€ Creates branch: visual-edit-{timestamp}            â•‘
â•‘     â””â”€ Automatic file backups (.backup files)             â•‘
â•‘     â””â”€ Commits with descriptive messages                  â•‘
â•‘     â””â”€ Pushes to remote repository                        â•‘
â•‘     â””â”€ Creates GitHub Pull Request                        â•‘
â•‘                                                            â•‘
â•‘  âœ… Deployment Pipeline                                    â•‘
â•‘     â”œâ”€ Preview: Shareable staging URL (24-hour validity)  â•‘
â•‘     â””â”€ Production: Auto-merge if Playwright tests pass    â•‘
â•‘                                                            â•‘
â•‘  âœ… Safety & Quality                                       â•‘
â•‘     â”œâ”€ Automatic backups before changes                   â•‘
â•‘     â”œâ”€ Full undo/redo history                             â•‘
â•‘     â”œâ”€ Test gates before production merge                 â•‘
â•‘     â””â”€ Complete Git rollback capability                   â•‘
â•‘                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1.3 User Interface Layout
Split-Pane Design:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Visual Editor                    [Fullscreen] [Exit]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LIVE PREVIEW (60%)        â”‚  MR. BLUE AI CHAT (40%)        â”‚
â”‚                            â”‚                                â”‚
â”‚  [Memories Page Preview]   â”‚  ðŸ’¬ Chat with Mr. Blue         â”‚
â”‚                            â”‚                                â”‚
â”‚  â€¢ Click any element       â”‚  "What can I help you with?"   â”‚
â”‚  â€¢ Drag to reposition      â”‚                                â”‚
â”‚  â€¢ See changes instantly   â”‚  â€¢ Ask design questions        â”‚
â”‚                            â”‚  â€¢ Get AI suggestions          â”‚
â”‚  [Edit Controls Panel]     â”‚  â€¢ View recent edits           â”‚
â”‚  â”œâ”€ Position               â”‚  â€¢ See learning insights       â”‚
â”‚  â”œâ”€ Size                   â”‚  â€¢ Conversational editing      â”‚
â”‚  â”œâ”€ Style                  â”‚                                â”‚
â”‚  â””â”€ Text                   â”‚  [Recent Edits]                â”‚
â”‚                            â”‚  â€¢ Button color changed        â”‚
â”‚  [Generate Code] [Preview] â”‚  â€¢ Heading text updated        â”‚
â”‚                            â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1.4 Component Architecture
VisualEditorOverlay (Main Container)
â”‚
â”œâ”€â”€ ComponentSelector
â”‚   â””â”€ Detects all elements with data-testid
â”‚   â””â”€ Highlights on hover (purple outline)
â”‚   â””â”€ Selects on click (solid purple border)
â”‚   â””â”€ Shows element inspector
â”‚
â”œâ”€â”€ DragDropHandler
â”‚   â””â”€ Enables visual repositioning
â”‚   â””â”€ Tracks position changes in real-time
â”‚   â””â”€ Shows alignment guides
â”‚   â””â”€ Integrates with VisualEditorTracker
â”‚
â”œâ”€â”€ EditControls (Tabbed Interface)
â”‚   â”‚
â”‚   â”œâ”€ PositionTab
â”‚   â”‚   â””â”€ X position (number input)
â”‚   â”‚   â””â”€ Y position (number input)
â”‚   â”‚   â””â”€ Quick actions: Center, Align Left, Align Right
â”‚   â”‚
â”‚   â”œâ”€ SizeTab
â”‚   â”‚   â””â”€ Width (px, %, rem, auto)
â”‚   â”‚   â””â”€ Height (px, %, rem, auto)
â”‚   â”‚   â””â”€ Aspect ratio lock (checkbox)
â”‚   â”‚
â”‚   â”œâ”€ StyleTab
â”‚   â”‚   â””â”€ Background color (color picker)
â”‚   â”‚   â””â”€ Text color (color picker)
â”‚   â”‚   â””â”€ Border (width, style, color, radius)
â”‚   â”‚   â””â”€ Padding (top, right, bottom, left)
â”‚   â”‚   â””â”€ Margin (top, right, bottom, left)
â”‚   â”‚   â””â”€ Font size, Font weight
â”‚   â”‚   â””â”€ Shadow (box-shadow controls)
â”‚   â”‚
â”‚   â””â”€ TextTab
â”‚       â””â”€ Text content (textarea)
â”‚       â””â”€ Font family (select dropdown)
â”‚       â””â”€ Text align (left, center, right, justify)
â”‚       â””â”€ Line height (slider)
â”‚
â”œâ”€â”€ VisualEditorTracker
â”‚   â””â”€ Tracks all changes in real-time
â”‚   â””â”€ Maintains change history (undo/redo)
â”‚   â””â”€ Serializes changes for AI generation
â”‚   â””â”€ Stores draft sessions in localStorage
â”‚
â””â”€â”€ MrBlueVisualChat (Right Panel)
    â””â”€ AI assistant chat interface
    â””â”€ Context-aware suggestions
    â””â”€ Recent edits display
    â””â”€ Learning insights panel
    â””â”€ Conversational editing support

1.5 Supported Edit Types
âœ… V1 - Currently Implemented:

Text Content:

Headings (h1, h2, h3, h4, h5, h6)
Paragraphs and body text
Button labels
Link text
Form labels and placeholders
List items
Layout & Positioning:

X/Y coordinates (absolute, relative, fixed)
Flexbox properties (justify, align)
Grid layout
Margin (spacing outside)
Padding (spacing inside)
Styling:

Colors (text, background, border)
Typography (font family, size, weight, line-height)
Borders (width, style, color, radius)
Shadows (box-shadow, text-shadow)
Opacity and visibility
Size:

Width (px, %, rem, vw, auto)
Height (px, %, rem, vh, auto)
Min/max width and height
Aspect ratio preservation
ðŸ”„ V2 - Roadmap (Future):

Structural Changes:

Add new sections/components
Remove elements
Duplicate components
Insert pre-built blocks
Reorder elements
Responsive Design:

Mobile/tablet/desktop views
Breakpoint-specific editing
Hide/show on different screen sizes
Global Updates:

Theme variable changes
Pattern-based updates (all buttons, all headings, etc.)
Component library integration
1.6 AI Code Generation Workflow
Step-by-Step Process:

User Makes Visual Changes

Click, drag, edit properties in UI
VisualEditorTracker records all changes
Click "Generate Code" Button

Serializes all tracked changes
Sends to backend API
OpenAI GPT-4o Processes

const completion = await openai.chat.completions.create({
  model: 'gpt-4o',
  messages: [
    {
      role: 'system',
      content: 'You are an expert React/Tailwind developer. Convert visual changes to production-ready code.'
    },
    {
      role: 'user',
      content: `Visual changes: ${JSON.stringify(changes)}\n\nCurrent file content: ${fileContent}`
    }
  ],
  response_format: { type: 'json_object' }
});

AI Returns:

{
  "updatedCode": "// New React/Tailwind code",
  "explanation": "Changed button color from blue to teal and increased padding...",
  "affectedFiles": ["client/src/pages/MemoriesPage.tsx"],
  "changes": [
    {
      "type": "style",
      "element": "button-create-memory",
      "before": "bg-blue-600 px-4 py-2",
      "after": "bg-teal-600 px-6 py-3"
    }
  ]
}

Code Preview Shown

Before/after diff displayed
Explanation of changes
User can review before applying
User Confirms

Code is written to files
Automatic backup created (.backup extension)
Git commit with descriptive message
1.7 Git Automation Details
Branch Creation:

# Automatic branch naming
visual-edit-{timestamp}
# Example: visual-edit-2025-11-03-14-30-45

File Operations:

// 1. Create backup
await fs.copyFile(
  'client/src/pages/MemoriesPage.tsx',
  'client/src/pages/MemoriesPage.tsx.backup'
);
// 2. Write new code
await fs.writeFile(
  'client/src/pages/MemoriesPage.tsx',
  updatedCode
);
// 3. Git add
exec('git add client/src/pages/MemoriesPage.tsx');
// 4. Git commit
exec('git commit -m "Visual edit: Update button styling on Memories page"');
// 5. Git push
exec('git push origin visual-edit-2025-11-03-14-30-45');

GitHub PR Creation:

// Using GitHub API
await octokit.pulls.create({
  owner: 'mundotango',
  repo: 'platform',
  title: 'Visual Edit: Memories Page Updates',
  body: `
## Visual Editor Changes
**Modified by**: [Super Admin Name]
**Page**: /memories
**Changes**:
- Updated button styling (button-create-memory)
- Changed colors from blue to teal
- Increased padding for better UX
**Files Modified**:
- client/src/pages/MemoriesPage.tsx
**Preview URL**: https://preview.mundotango.com/visual-edit-2025-11-03
**Tests**: Will run automatically on PR
  `,
  head: 'visual-edit-2025-11-03-14-30-45',
  base: 'main'
});

1.8 Deployment Pipeline
Preview Deployment (Staging):

1. Push code to feature branch
2. Trigger preview build (Replit deployment)
3. Generate shareable URL: https://preview.mundotango.com/{branch-name}
4. URL valid for 24 hours
5. Share with stakeholders for review

Production Deployment:

1. Playwright tests run on GitHub PR
2. If all tests pass:
   a. Auto-merge PR to main branch
   b. Production deployment triggered
   c. Changes go live
3. If any tests fail:
   a. PR blocked from merging
   b. Super admin notified
   c. Manual review required

1.9 Safety Features
Automatic Backups:

Every file modification creates .backup copy
Backups stored with timestamp
Easy rollback if needed
Undo/Redo System:

Complete change history tracked
Undo: Ctrl/Cmd + Z
Redo: Ctrl/Cmd + Shift + Z
Up to 50 actions stored
Test Gates:

Playwright tests must pass before production
Visual regression tests (screenshot comparison)
Accessibility tests (WCAG compliance)
Performance tests (Lighthouse scores)
Git Rollback:

All changes in Git history
Can revert any commit
Can checkout previous versions
Full audit trail
2. MR. BLUE INTELLIGENCE SYSTEM
2.1 Overview
Mr. Blue (Agents #73-80) is the universal AI companion that provides context-aware support throughout the platform. Think of it as "Replit Agent" integrated into Mundo Tango.

2.2 Agent Roles (Agents #73-80)
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  MR. BLUE AGENT TEAM                                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                            â•‘
â•‘  Agent #73: Mr. Blue Avatar                                â•‘
â•‘  â”œâ”€ 3D humanoid avatar (React Three Fiber)                 â•‘
â•‘  â”œâ”€ Voice + text chat interface (Web Speech API)           â•‘
â•‘  â”œâ”€ Lip-sync with TTS output                               â•‘
â•‘  â””â”€ Visual Editor activation trigger                       â•‘
â•‘                                                            â•‘
â•‘  Agent #74: Interactive Tour Guide                         â•‘
â•‘  â”œâ”€ Page-specific tours and walkthroughs                   â•‘
â•‘  â”œâ”€ Feature discovery assistance                           â•‘
â•‘  â”œâ”€ Contextual tooltips                                    â•‘
â•‘  â””â”€ First-visit onboarding                                 â•‘
â•‘                                                            â•‘
â•‘  Agent #75: Subscription Manager                           â•‘
â•‘  â”œâ”€ Billing and subscription guidance                      â•‘
â•‘  â”œâ”€ Payment issue resolution                               â•‘
â•‘  â”œâ”€ Tier comparison and recommendations                    â•‘
â•‘  â””â”€ Usage tracking and limits                              â•‘
â•‘                                                            â•‘
â•‘  Agent #76: Replit Architecture Expert                     â•‘
â•‘  â”œâ”€ Code modification patterns                             â•‘
â•‘  â”œâ”€ Safe sandbox for preview deployments                   â•‘
â•‘  â”œâ”€ Best practices enforcement                             â•‘
â•‘  â””â”€ Performance optimization suggestions                   â•‘
â•‘                                                            â•‘
â•‘  Agent #77: Context Provider & Support Specialist          â•‘
â•‘  â”œâ”€ Current page context awareness                         â•‘
â•‘  â”œâ”€ Recent action history tracking (breadcrumbs)           â•‘
â•‘  â”œâ”€ Proactive assistance on errors                         â•‘
â•‘  â””â”€ User intent classification                             â•‘
â•‘                                                            â•‘
â•‘  Agent #78: Visual Page Editor                             â•‘
â•‘  â”œâ”€ Figma-like editing capabilities                        â•‘
â•‘  â”œâ”€ AI code generation orchestration                       â•‘
â•‘  â”œâ”€ Git workflow automation                                â•‘
â•‘  â””â”€ Component change tracking                              â•‘
â•‘                                                            â•‘
â•‘  Agent #79: Quality Validator & Builder                    â•‘
â•‘  â”œâ”€ Pre-work quality gates (Principle 5)                   â•‘
â•‘  â”œâ”€ Build orchestration                                    â•‘
â•‘  â”œâ”€ Test execution and validation                          â•‘
â•‘  â””â”€ Post-deployment monitoring                             â•‘
â•‘                                                            â•‘
â•‘  Agent #80: Learning Coordinator                           â•‘
â•‘  â”œâ”€ Pattern recognition across all 114 agents              â•‘
â•‘  â”œâ”€ Knowledge distribution and sharing                     â•‘
â•‘  â”œâ”€ ML model training and updates                          â•‘
â•‘  â””â”€ Cross-agent learning synthesis                         â•‘
â•‘                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

2.3 Context Awareness System
What Mr. Blue Knows at All Times:

interface MrBlueContext {
  // 1. Current Page
  currentPage: string;           // "/memories", "/groups", etc.
  pageTitle: string;             // "Memories", "Groups"
  pagePurpose: string;           // "Social feed for sharing moments"
  pageElements: Element[];        // All elements with data-testid
  selectedElement?: Element;      // Currently selected in Visual Editor
  
  // 2. Recent Activity (Breadcrumbs)
  last30Clicks: Breadcrumb[];     // 30 most recent clicks
  last7Days: Breadcrumb[];        // All activity past week
  recentErrors: FailedAction[];   // Last 3 errors/failures
  
  // 3. User Context
  userId: number;
  userName: string;
  userRole: string;               // "super_admin", "user", "pro"
  userIntent: string;             // AI-predicted: "exploring", "creating", etc.
  userJourney: string;            // "J01", "J02", etc. (1-15)
  
  // 4. Session Context
  sessionId: string;
  sessionStartTime: Date;
  pagesVisited: string[];         // Pages in current session
  actionsPerformed: number;       // Total actions this session
  
  // 5. Visual Editor Context (if active)
  visualEditorActive: boolean;
  selectedComponent?: {
    testId: string;
    tagName: string;
    textContent: string;
    className: string;
    filePath: string;
    lineNumber: number;
  };
  recentEdits: VisualEdit[];      // Recent Visual Editor changes
  
  // 6. Patterns & Predictions
  detectedPatterns: UserPattern[];
  predictedNextActions: Prediction[];
  confidence: number;             // 0-1 (prediction confidence)
  
  // 7. Active Agents
  activeAgents: string[];         // Agents currently active on page
  agentRecommendations: string[]; // Agent suggestions
}

Example Context on Memories Page:

{
  "currentPage": "/memories",
  "pageTitle": "Memories",
  "pagePurpose": "Social feed for sharing tango memories and moments",
  "activeAgents": ["Agent #2 (Social Feed)", "Agent #73 (Mr. Blue)", "Algorithm A1"],
  "last30Clicks": [
    {
      "action": "click",
      "target": "button-create-memory",
      "timestamp": "2025-11-03T14:25:00Z",
      "success": true
    },
    {
      "action": "click",
      "target": "button-upload-photo",
      "timestamp": "2025-11-03T14:25:15Z",
      "success": true
    }
  ],
  "userIntent": "creating",
  "predictedNextActions": [
    { "action": "add-caption", "probability": 0.85 },
    { "action": "tag-friends", "probability": 0.72 },
    { "action": "share-to-feed", "probability": 0.68 }
  ]
}

2.4 Breadcrumb Tracking System
Industry Standard: 30 Clicks or 7 Days (whichever comes first)

Why These Limits?:

30 clicks: Enough for ML pattern detection
7 days: Captures weekly behavior patterns
Storage: ~15KB per user (30 clicks Ã— 500 bytes)
ML Training: Minimum 30 actions needed for accurate predictions
Data Structure:

interface Breadcrumb {
  // Unique Identifiers
  id: string;
  userId: number;
  sessionId: string;
  timestamp: Date;
  
  // Page Context
  page: string;                   // Current page URL
  pageTitle: string;             // Page title
  referrer: string;              // Previous page
  
  // Action Context
  action: 'click' | 'view' | 'input' | 'submit' | 'error' | 'navigation';
  target: string;                // Element clicked/interacted
  targetId?: string;             // data-testid or element ID
  value?: any;                   // Input value, form data
  
  // User Context
  userJourney: string;           // J1-J15 journey
  userRole: string;              // Role at time of action
  userIntent?: string;           // AI-predicted intent
  
  // Outcome
  success: boolean;              // Did action succeed?
  error?: string;                // Error message if failed
  duration?: number;             // Time spent on page/action (ms)
  
  // ML Predictions
  prediction?: string;           // AI prediction for next action
  confidence?: number;           // Prediction confidence (0-1)
  patternId?: string;            // Detected pattern ID
}

What Gets Tracked:

Page Navigation: Every page view

{
  action: 'navigation',
  page: '/memories',
  pageTitle: 'Memories',
  referrer: '/feed',
  timestamp: Date.now()
}

Click Events: All interactive elements with data-testid

{
  action: 'click',
  target: 'button-create-memory',
  targetId: 'button-create-memory',
  page: '/memories',
  success: true
}

Form Submissions: All form submits

{
  action: 'submit',
  target: 'form-create-memory',
  value: { caption: '...', photos: [...] },
  success: true
}

Input Changes: Debounced input tracking (1s delay)

{
  action: 'input',
  target: 'input-search',
  value: 'tango events',
  page: '/events'
}

API Errors: Automatic 400/500 error tracking

{
  action: 'error',
  target: '/api/memories',
  error: '403 Forbidden: Insufficient permissions',
  success: false
}

404 Errors: Page not found tracking

{
  action: 'error',
  target: '/invalid-page',
  error: '404 Not Found',
  success: false
}

2.5 Failed Action Monitoring
Types of Failures Tracked:

404 Errors: Page not found
API Errors: 400, 401, 403, 500 series
Form Validation Errors: Client-side + server-side
Permission Errors: Unauthorized actions
Network Errors: Timeout, connection failed
UI Errors: React error boundaries
User Frustration: Rapid clicks, back button spam, rage quit
Failed Action Data Structure:

interface FailedAction extends Breadcrumb {
  failureType: '404' | 'api_error' | 'validation' | 'permission' | 'network' | 'ui_error' | 'frustration';
  statusCode?: number;
  errorDetails: {
    message: string;
    stack?: string;
    userMessage?: string;  // User-friendly error message
  };
  recovery?: {
    attempted: boolean;
    successful: boolean;
    retries: number;
  };
}

Proactive Assistance Examples:

Example 1: 403 Permission Error

// User tries to create event but gets 403
onApiError(error) {
  if (error.status === 403) {
    showMrBlue({
      message: "You need special permissions to create events. Would you like me to:",
      actions: [
        "Request permission from admin",
        "View events instead",
        "Contact support"
      ],
      context: {
        failedAction: 'create-event',
        userIntent: 'organize-event',
        suggestedPath: '/events/request-permission'
      }
    });
  }
}

Example 2: Form Validation Error

// User submits form with missing required fields
onFormError(errors) {
  showMrBlue({
    message: "I noticed some required fields are missing:",
    actions: errors.map(e => `Fix: ${e.field}`),
    context: {
      failedAction: 'form-submit',
      formId: 'create-event-form',
      missingFields: errors.map(e => e.field)
    }
  });
}

Example 3: Network Timeout

// API call times out
onNetworkError(error) {
  showMrBlue({
    message: "Your connection seems slow. I can:",
    actions: [
      "Retry the request",
      "Save your work locally",
      "Continue offline"
    ],
    context: {
      failedAction: 'api-request',
      endpoint: error.url,
      retryable: true
    }
  });
}

2.6 ML Pattern Recognition
ML Models Implemented:

1. Next-Action Prediction (LSTM)

// Input: Last 10 breadcrumbs
// Output: Top 3 predicted actions with probabilities
// Technology: TensorFlow.js
// Accuracy Target: 70%+ for top-3 predictions
const model = tf.sequential({
  layers: [
    tf.layers.lstm({ units: 128, inputShape: [10, featureCount] }),
    tf.layers.dropout({ rate: 0.2 }),
    tf.layers.dense({ units: 64, activation: 'relu' }),
    tf.layers.dense({ units: actionCount, activation: 'softmax' })
  ]
});
// Example prediction
{
  predictions: [
    { action: 'add-caption', probability: 0.85 },
    { action: 'tag-friends', probability: 0.72 },
    { action: 'share-to-feed', probability: 0.68 }
  ]
}

2. User Intent Classification

// Intents detected:
const intents = [
  'exploring',      // Browsing, discovering
  'searching',      // Looking for something specific
  'creating',       // Making content (post, event, etc.)
  'socializing',    // Engaging with friends
  'managing',       // Settings, profile updates
  'learning',       // Reading docs, tutorials
  'troubleshooting' // Fixing something, getting help
];
// Used for: Context-aware Mr Blue suggestions

3. Pattern Detection

interface UserPattern {
  patternId: string;
  userId: number;
  journey: string;            // J1-J15
  
  // Common action sequences
  commonSequences: {
    actions: string[];        // ['view-events', 'create-event', 'invite-friends']
    frequency: number;        // How often this sequence occurs
    successRate: number;      // % of times sequence completes successfully
  }[];
  
  // Time-based patterns
  timePatterns: {
    dayOfWeek: number;        // 0-6 (Sun-Sat)
    hourOfDay: number;        // 0-23
    avgSessionLength: number; // minutes
    peakActivityTime: string; // "9am-11am weekdays"
  };
  
  // Feature preferences
  preferredFeatures: string[];  // ['events', 'groups', 'map']
  avoidedFeatures: string[];    // ['video-calls', 'streaming']
  expertiseLevel: 'beginner' | 'intermediate' | 'expert';
  
  // Predicted next actions
  nextActions: {
    action: string;
    probability: number;      // 0-1
    context: string[];        // When this action is likely
  }[];
}

2.7 Cross-Page Context Preservation
How Context Persists Across Navigation:

// 1. Store context on page unload
window.addEventListener('beforeunload', () => {
  localStorage.setItem('mrBlue:context', JSON.stringify({
    lastPage: window.location.pathname,
    lastAction: lastBreadcrumb,
    userIntent: currentIntent,
    timestamp: Date.now()
  }));
});
// 2. Restore context on new page load
useEffect(() => {
  const savedContext = localStorage.getItem('mrBlue:context');
  if (savedContext) {
    const context = JSON.parse(savedContext);
    
    // Mr Blue knows user came from another page
    mrBlue.setContext({
      previousPage: context.lastPage,
      previousAction: context.lastAction,
      continuedIntent: context.userIntent
    });
    
    // Can provide contextual suggestions
    if (context.userIntent === 'creating') {
      mrBlue.suggest("Want to continue creating your event?");
    }
  }
}, []);

Context Storage:

interface UserContext {
  userId: number;
  sessionId: string;
  
  // Current State
  currentPage: string;
  currentIntent: string;
  currentJourney: string;        // J1-J15
  
  // Recent History (from breadcrumbs)
  recentPages: string[];         // Last 5 pages
  recentActions: Breadcrumb[];   // Last 10 actions
  recentErrors: FailedAction[];  // Last 3 errors
  
  // User Preferences (persistent)
  preferences: {
    language: string;
    theme: 'light' | 'dark';
    viewMode: string;            // 'list' | 'grid' | 'map'
    filters: Record<string, any>;
  };
  
  // Progress Tracking
  onboarding: {
    completed: boolean;
    currentStep: number;
    skippedSteps: number[];
  };
  
  // Feature Discovery
  discoveredFeatures: string[];
  undiscoveredFeatures: string[];
  
  // Mr. Blue Interaction Stats
  mrBlueInteractions: {
    totalInteractions: number;
    helpfulCount: number;         // User clicked "helpful"
    dismissedCount: number;       // User dismissed suggestions
    lastInteraction: Date;
  };
}

2.8 Learning Coordination (Agent #80)
Agent #80's Role:

Collect learnings from all 114 agents
Identify patterns across the entire platform
Distribute knowledge to relevant agents
Train and update ML models
Coordinate agent collaboration
Learning Collection:

class LearningCoordinator {
  async collectAgentLearnings() {
    // Gather from all agents
    const learnings = await Promise.all([
      agent73.getLearnings(),  // Mr. Blue Avatar
      agent74.getLearnings(),  // Tour Guide
      agent75.getLearnings(),  // Subscription Manager
      // ... all 114 agents
    ]);
    
    // Synthesize insights
    const insights = this.synthesizeLearnings(learnings);
    
    // Distribute to relevant agents
    await this.distributeKnowledge(insights);
    
    // Update ML models
    await this.trainModels(learnings);
  }
  
  synthesizeLearnings(learnings) {
    // Find common patterns
    const patterns = this.detectPatterns(learnings);
    
    // Identify best practices
    const bestPractices = this.identifyBestPractices(learnings);
    
    // Spot potential issues
    const issues = this.identifyIssues(learnings);
    
    return { patterns, bestPractices, issues };
  }
  
  async distributeKnowledge(insights) {
    // Share relevant insights with each agent
    for (const agent of allAgents) {
      const relevantInsights = this.filterRelevant(insights, agent);
      await agent.receiveKnowledge(relevantInsights);
    }
  }
}

2.9 COMPLETE PLATFORM INTELLIGENCE (Beyond Visual Editor)
Mr. Blue's intelligence extends FAR beyond Visual Editor integration. This section documents ALL capabilities across the entire platform.

2.9.1 ACCESS TO ALL 88+ PLATFORM PAGES
Mr. Blue has universal access to every page on the platform, not just pages in Visual Editor mode. This enables comprehensive support anywhere.

Complete Page Registry:

// From client/src/config/routes.ts (1024 lines)
export const ALL_PAGES = {
  // Authentication (4 pages)
  auth: ['/login', '/register', '/forgot-password', '/reset-password'],
  
  // User Management (10 pages)
  user: ['/profile/:username?', '/settings', '/account-delete', '/onboarding', 
         '/resume', '/public-resume/:username', '/public-profile/:username', 
         '/profile-switcher', '/favorites', '/role-invitations'],
  
  // Events (4 pages)
  events: ['/events', '/event/:id', '/teacher', '/organizer'],
  
  // Housing (7 pages)
  housing: ['/housing', '/host-dashboard', '/host-onboarding', '/guest-onboarding',
            '/host-bookings', '/my-bookings', '/listing/:id', '/host-calendar'],
  
  // Social (9 pages)
  social: ['/recommendations', '/friends', '/friendship/:id', '/messages', 
           '/groups', '/group/:id', '/community', '/community-map', 
           '/create-community'],
  
  // Community Features (5 pages)
  community: ['/tango-communities', '/tango-stories', '/live-streaming', 
              '/gamification', '/search'],
  
  // Billing (7 pages)
  billing: ['/subscribe', '/pricing', '/billing', '/checkout', 
            '/payment-methods', '/invoices', '/subscription'],
  
  // Admin Pages (19 pages)
  admin: ['/admin/dashboard', '/admin/users', '/admin/moderation', 
          '/admin/analytics', '/admin/center', '/admin/promo-codes',
          '/admin/subscription-analytics', '/admin/agent-metrics',
          '/admin/projects', '/admin/epics', '/admin/stories',
          '/admin/epic/:id', '/admin/story/:id', '/admin/sprints',
          '/admin/esa-mind', '/admin/mr-blue', '/admin/tenant-management',
          '/admin/agent-learnings', '/admin/deployment-config'],
  
  // Advanced Admin (10 pages)
  advancedAdmin: ['/admin/agent-collaboration', '/admin/multi-ai',
                  '/admin/multi-ai-analytics', '/admin/ui-sub-agents',
                  '/admin/health-monitor', '/admin/page-state-monitor',
                  '/admin/auto-fix', '/admin/performance', '/admin/agent-coordination',
                  '/finops'],
  
  // Dashboards & Monitoring (10 pages)
  dashboards: ['/analytics', '/agent-framework', '/project-tracker',
               '/live-stats', '/hierarchy', '/life-ceo', '/life-ceo-performance',
               '/monitoring', '/monitoring-test', '/media-upload-test'],
  
  // Support & Compliance (5 pages)
  support: ['/feature-navigation', '/database-security', '/help', 
            '/code-of-conduct', '/privacy-analytics'],
  
  // App Features (6 pages)
  features: ['/travel-planner', '/mobile-app', '/notifications', 
             '/error-boundary', '/agent-learning', '/agent-intelligence',
             '/agent/:id', '/marketing'],
  
  // Core App (2 pages)
  core: ['/', '/memories'],
  
  // Debug Pages (4 pages)
  debug: ['/_debug/memories', '/_debug/memories-test', '/_debug/posting',
          '/_debug/modern-memories']
};
// Total: 88+ pages
const totalPages = Object.values(ALL_PAGES).flat().length; // 88+

Mr. Blue's Page-Specific Context:

interface PageContext {
  // Page Identity
  route: string;              // '/memories', '/events', etc.
  category: string;           // 'social', 'admin', 'housing', etc.
  pageTitle: string;          // "Memories", "Events", etc.
  pagePurpose: string;        // Description of what page does
  
  // Page Capabilities
  interactiveElements: Element[];  // All data-testid elements
  availableActions: Action[];      // What users can do here
  requiredPermissions: string[];   // Role requirements
  
  // Page Agents
  primaryAgent: string;       // e.g., "Agent #73 (Mr. Blue)"
  supportingAgents: string[]; // e.g., ["Agent #2 (Social Feed)", "Algorithm A1"]
  
  // User Journey Context
  journeyPhase: string;       // Which of 15 journeys user is on
  entryPoint: string;         // How user arrived at this page
  exitOptions: string[];      // Where user can go next
  
  // Integration Points
  connectedFeatures: string[]; // Other features this page connects to
  dataFlows: DataFlow[];       // API calls, database operations
}

Example: Mr. Blue on Memories Page

{
  "route": "/memories",
  "category": "social",
  "pageTitle": "Memories",
  "pagePurpose": "Social feed for sharing tango memories and moments",
  "interactiveElements": [
    "button-create-memory",
    "button-upload-photo",
    "button-add-caption",
    "button-tag-friends",
    "button-share-to-feed"
  ],
  "availableActions": [
    "create_memory",
    "upload_media",
    "tag_users",
    "like_memory",
    "comment_on_memory"
  ],
  "requiredPermissions": ["authenticated"],
  "primaryAgent": "Agent #73 (Mr. Blue Avatar)",
  "supportingAgents": [
    "Agent #24 (Social Features)",
    "Agent #13 (File Management)",
    "Algorithm A1 (Feed Algorithm)"
  ],
  "journeyPhase": "J02 (Community Engagement)",
  "entryPoint": "navigation_menu",
  "exitOptions": ["/events", "/groups", "/friends", "/profile"],
  "connectedFeatures": ["social_feed", "media_upload", "friend_tagging"]
}

Example: Mr. Blue on Admin ESA Mind Page

{
  "route": "/admin/esa-mind",
  "category": "admin",
  "pageTitle": "ESA Mind - Intelligence Dashboard",
  "pagePurpose": "Context-aware intelligence dashboard for ESA Framework (105 Agents, 61 Layers)",
  "interactiveElements": [
    "view-agent-status",
    "view-layer-health",
    "view-system-intelligence",
    "view-agent-collaboration",
    "view-learning-insights"
  ],
  "availableActions": [
    "view_agent_status",
    "monitor_layer_health",
    "analyze_agent_collaboration",
    "review_learning_data"
  ],
  "requiredPermissions": ["super_admin"],
  "primaryAgent": "Agent #0 (ESA Orchestrator)",
  "supportingAgents": [
    "Agent #73-80 (Mr. Blue Team)",
    "Agent #68 (Pattern Learning)",
    "Agent #80 (Learning Coordinator)"
  ],
  "journeyPhase": "J15 (Platform Administration)",
  "entryPoint": "admin_menu",
  "exitOptions": ["/admin/dashboard", "/admin/agent-metrics", "/admin/multi-ai"],
  "connectedFeatures": ["agent_intelligence_network", "esa_framework", "learning_coordination"]
}

2.9.2 ORCHESTRATION OF ALL 115 AGENTS
Mr. Blue doesn't just know about agents - Mr. Blue ORCHESTRATES all 115 agents across the platform.

Complete Agent Ecosystem:

interface AgentEcosystem {
  // ESA Framework Agents (105 total)
  esaAgents: {
    ceo: 'Agent #0 (ESA Orchestrator)',
    
    // Division Chiefs (6)
    chiefs: [
      'Chief #1 (Foundation Division - Layers 1-10)',
      'Chief #2 (Core Division - Layers 11-20)',
      'Chief #3 (Business Division - Layers 21-30)',
      'Chief #4 (Intelligence Division - Layers 31-46)',
      'Chief #5 (Platform Division - Layers 47-56)',
      'Chief #6 (Extended Division - Layers 57-61)'
    ],
    
    // Core Domain Agents (9)
    domains: [
      'Domain #1 (Infrastructure Orchestrator)',
      'Domain #2 (Frontend Coordinator)',
      'Domain #3 (Background Processor)',
      'Domain #4 (Real-time Communications)',
      'Domain #5 (Business Logic Manager)',
      'Domain #6 (Search & Analytics)',
      'Domain #7 (Life CEO Core)',
      'Domain #8 (Platform Enhancement)',
      'Domain #9 (Master Control)'
    ],
    
    // Layer Agents (61)
    layers: [
      'Agent #1 (Database Architecture)',
      'Agent #2 (API Structure)',
      // ... all 61 layers
      'Agent #61 (Supabase Expertise)'
    ],
    
    // Expert Agents (7)
    experts: [
      'Agent #10-16 (Specialized Experts)'
    ]
  },
  
  // Life CEO Agents (16)
  lifeCeoAgents: [
    'life-ceo (Central Coordinator)',
    'business', 'finance', 'health',
    'relationships', 'learning', 'creative',
    'network', 'global-mobility', 'security',
    'emergency', 'memory', 'voice',
    'data', 'workflow', 'legal'
  ],
  
  // Mr. Blue Team (8)
  mrBlueAgents: [
    'Agent #73 (Mr. Blue Avatar)',
    'Agent #74 (Interactive Tour Guide)',
    'Agent #75 (Subscription Manager)',
    'Agent #76 (Replit Architecture Expert)',
    'Agent #77 (Context Provider)',
    'Agent #78 (Visual Page Editor)',
    'Agent #79 (Quality Validator)',
    'Agent #80 (Learning Coordinator)'
  ],
  
  // Component Agents (30+)
  componentAgents: [
    'Page Agents (P1-P88+ for each page)',
    'Algorithm Agents (A1-Ax)',
    'Service Agents (Backend services)',
    'Feature Agents (Complex features)'
  ],
  
  // Total: 115 agents (105 ESA + 8 Mr. Blue + 16 Life CEO + component agents)
  totalAgents: 115
}

Agent Orchestration Workflow:

class MrBlueOrchestrator {
  // When user asks: "Create a new event management feature"
  async orchestrateFeatureBuild(request: string) {
    // Step 1: Parse request with AI
    const analysis = await this.analyzeRequest(request);
    
    // Step 2: Identify required agents
    const requiredAgents = this.identifyRequiredAgents(analysis);
    // Returns: [
    //   'Agent #1 (Database)' â†’ Create events table,
    //   'Agent #2 (API)' â†’ Build event endpoints,
    //   'Agent #8 (Frontend)' â†’ Create event UI components,
    //   'Agent #23 (Event Management)' â†’ Business logic,
    //   'Agent #78 (Visual Editor)' â†’ Visual design tool
    // ]
    
    // Step 3: Check with Agent #64 (Documentation Specialist)
    const existingComponents = await agent64.checkForDuplicates(analysis);
    if (existingComponents.length > 0) {
      return {
        status: 'reuse_existing',
        message: 'Found existing event system. Extend instead of rebuild?',
        components: existingComponents
      };
    }
    
    // Step 4: Create parallel build plan
    const buildPlan = this.createParallelPlan(requiredAgents);
    // Returns:
    // {
    //   track1: [Agent #1 + Agent #2] â†’ Database + API (parallel),
    //   track2: [Agent #8 + Agent #23] â†’ Frontend + Logic (parallel),
    //   track3: [Agent #78] â†’ Visual Editor integration
    // }
    
    // Step 5: Execute in parallel (ESA Principle 1)
    const results = await Promise.all([
      this.executeBuildTrack(buildPlan.track1),
      this.executeBuildTrack(buildPlan.track2),
      this.executeBuildTrack(buildPlan.track3)
    ]);
    
    // Step 6: Quality Validation (Agent #79)
    const validationResults = await agent79.validate(results);
    
    // Step 7: Learning Coordination (Agent #80)
    await agent80.collectLearnings(results);
    
    return {
      status: 'success',
      agentsUsed: requiredAgents,
      buildResults: results,
      validationScore: validationResults.score
    };
  }
  
  // Agent selection algorithm
  identifyRequiredAgents(analysis) {
    const agents = [];
    
    // Database changes needed?
    if (analysis.requiresDatabase) {
      agents.push('Agent #1 (Database Architecture)');
    }
    
    // API endpoints needed?
    if (analysis.requiresAPI) {
      agents.push('Agent #2 (API Structure)');
    }
    
    // Frontend UI needed?
    if (analysis.requiresFrontend) {
      agents.push('Agent #8 (Client Framework)');
      agents.push('Agent #9 (UI Framework)');
    }
    
    // Business logic?
    if (analysis.requiresBusinessLogic) {
      const businessAgent = this.selectBusinessAgent(analysis.domain);
      agents.push(businessAgent);
    }
    
    // Real-time features?
    if (analysis.requiresRealtime) {
      agents.push('Agent #11 (Real-time Features)');
    }
    
    // AI/ML features?
    if (analysis.requiresAI) {
      agents.push('Agent #31 (Core AI Infrastructure)');
      agents.push('Agent #35 (AI Agent Management)');
    }
    
    // Always include Mr. Blue coordination
    agents.push('Agent #73 (Mr. Blue Avatar)');
    agents.push('Agent #80 (Learning Coordinator)');
    
    return agents;
  }
}

Real-World Orchestration Example:

User Request: "Build a housing marketplace feature"

Mr. Blue's Orchestration:

{
  "request": "Build a housing marketplace feature",
  "analysis": {
    "requiresDatabase": true,
    "requiresAPI": true,
    "requiresFrontend": true,
    "requiresBusinessLogic": true,
    "requiresPayments": true,
    "requiresSearch": true,
    "requiresMap": true
  },
  "selectedAgents": [
    "Agent #1 (Database) â†’ Create listings, bookings, reviews tables",
    "Agent #2 (API) â†’ Build CRUD endpoints for housing",
    "Agent #8 (Frontend) â†’ Housing marketplace UI",
    "Agent #9 (UI) â†’ Listing cards, filters, search",
    "Agent #28 (Marketplace) â†’ Business logic for housing",
    "Agent #29 (Booking System) â†’ Reservation management",
    "Agent #17 (Payment Processing) â†’ Stripe integration",
    "Agent #15 (Search & Discovery) â†’ Search/filter listings",
    "Agent #41 (Vision Processing) â†’ Photo uploads",
    "Agent #78 (Visual Editor) â†’ Admin can edit housing pages",
    "Agent #79 (Quality Validator) â†’ Pre-work quality gates",
    "Agent #80 (Learning Coordinator) â†’ Collect insights"
  ],
  "parallelBuildPlan": {
    "track1_database_api": [
      "Agent #1 creates schema",
      "Agent #2 builds API routes",
      "(Sequential within track, parallel with other tracks)"
    ],
    "track2_frontend": [
      "Agent #8 creates page structure",
      "Agent #9 builds UI components",
      "(Parallel with track1)"
    ],
    "track3_features": [
      "Agent #28 implements marketplace logic",
      "Agent #29 builds booking system",
      "Agent #17 integrates payments",
      "(Parallel with track1 and track2)"
    ],
    "track4_enhancement": [
      "Agent #15 adds search",
      "Agent #41 handles images",
      "Agent #78 enables visual editing",
      "(Parallel with all other tracks)"
    ]
  },
  "estimatedTime": "2-3 days (with parallel execution)",
  "estimatedTimeSequential": "8-10 days (without parallelism)"
}

2.9.3 MCP (MODEL CONTEXT PROTOCOL) INTEGRATION
Mr. Blue uses MCP (Model Context Protocol) via Playwright integration for advanced browser automation and testing coordination.

What is MCP?:

Model Context Protocol = standardized way for AI models to interact with tools, APIs, and resources
Found in: node_modules/playwright/lib/mcp/ (Playwright's MCP SDK)
Purpose: Enable Mr. Blue to coordinate Playwright tests, browser automation, and quality validation
MCP Architecture:

// From node_modules/playwright/lib/mcp/
interface MCPIntegration {
  // Core MCP Components
  server: {
    path: 'node_modules/playwright/lib/mcp/sdk/server.js',
    purpose: 'MCP server for handling tool requests'
  },
  
  bundle: {
    path: 'node_modules/playwright/lib/mcp/sdk/bundle.js',
    purpose: 'Bundled MCP SDK for client-side integration'
  },
  
  tools: {
    path: 'node_modules/playwright/lib/mcp/sdk/tool.js',
    purpose: 'Tool interface for MCP commands'
  },
  
  backends: {
    browser: 'node_modules/playwright/lib/mcp/browser/browserServerBackend.js',
    proxy: 'node_modules/playwright/lib/mcp/sdk/proxyBackend.js',
    test: 'node_modules/playwright/lib/mcp/test/browserBackend.js'
  }
}

How Mr. Blue Uses MCP:

1. Visual Editor Testing (Agent #78 + MCP):

// When user makes visual changes, Agent #78 uses MCP to test them
class VisualEditorMCPIntegration {
  async testVisualChanges(changes: VisualEdit[]) {
    // Step 1: Use MCP to launch Playwright browser
    const mcpBrowser = await mcp.launchBrowser({
      context: 'visual-editor-test',
      headless: false  // Show browser for visual verification
    });
    
    // Step 2: Navigate to page with changes
    const page = await mcpBrowser.newPage();
    await page.goto(`http://localhost:5000${changes[0].page}`);
    
    // Step 3: Verify visual changes applied correctly
    const element = await page.locator(`[data-testid="${changes[0].componentId}"]`);
    const actualStyles = await element.evaluate(el => getComputedStyle(el));
    
    // Step 4: Take screenshot for visual regression
    const screenshot = await page.screenshot({ fullPage: true });
    
    // Step 5: Run accessibility tests via MCP
    const accessibilityResults = await mcp.runAccessibilityAudit(page);
    
    // Step 6: Return test results
    return {
      visualMatch: this.compareStyles(changes[0].after, actualStyles),
      screenshot,
      accessibility: accessibilityResults,
      passed: true
    };
  }
}

2. Quality Validation (Agent #79 + MCP):

// Agent #79 uses MCP for comprehensive quality gates
class QualityValidatorMCP {
  async runQualityGates(deployment: Deployment) {
    // Use MCP to orchestrate multiple test types
    const results = await Promise.all([
      // Functional tests
      mcp.runTests({
        type: 'functional',
        suite: 'playwright/tests/**/*.spec.ts',
        browser: ['chromium', 'firefox', 'webkit']
      }),
      
      // Visual regression tests
      mcp.runTests({
        type: 'visual',
        suite: 'playwright/tests/visual/**/*.spec.ts',
        compareScreenshots: true
      }),
      
      // Accessibility tests
      mcp.runTests({
        type: 'accessibility',
        tool: 'axe-core',
        standard: 'WCAG 2.1 AA'
      }),
      
      // Performance tests
      mcp.runTests({
        type: 'performance',
        tool: 'lighthouse',
        thresholds: {
          performance: 90,
          accessibility: 95,
          bestPractices: 90,
          seo: 90
        }
      })
    ]);
    
    // Aggregate results
    return {
      functional: results[0].passed,
      visual: results[1].passed,
      accessibility: results[2].passed,
      performance: results[3].passed,
      allPassed: results.every(r => r.passed)
    };
  }
}

3. Browser Context Management (Agent #77 + MCP):

// Agent #77 uses MCP to track user context across browser sessions
class ContextProviderMCP {
  async trackUserBehavior(userId: number) {
    // Use MCP to monitor real user sessions
    const mcpContext = await mcp.createContext({
      userId,
      tracking: {
        clicks: true,
        navigation: true,
        errors: true,
        performance: true
      }
    });
    
    // MCP captures all user interactions
    mcpContext.on('click', (event) => {
      this.trackBreadcrumb({
        action: 'click',
        target: event.target,
        timestamp: Date.now()
      });
    });
    
    mcpContext.on('error', (error) => {
      this.trackFailedAction({
        failureType: 'ui_error',
        errorDetails: error,
        timestamp: Date.now()
      });
    });
    
    mcpContext.on('navigation', (navigation) => {
      this.updatePageContext({
        page: navigation.url,
        timestamp: Date.now()
      });
    });
  }
}

MCP Benefits for Mr. Blue:

Automated Testing: MCP handles browser automation for Agent #78 (Visual Editor) and Agent #79 (Quality Validator)
Cross-Browser Validation: Test changes in Chromium, Firefox, and WebKit simultaneously
Visual Regression: Compare screenshots before/after visual edits
Accessibility Audits: Run axe-core and WCAG compliance checks
Performance Monitoring: Lighthouse audits via MCP
User Behavior Tracking: Monitor real user sessions for breadcrumb tracking
2.9.4 AGENT-TO-AGENT COMMUNICATION NETWORK
All 115 agents can communicate with each other through the Agent Intelligence Network.

Communication Architecture:

// Database: agentCommunications table
export const agentCommunications = pgTable("agent_communications", {
  id: serial("id").primaryKey(),
  fromAgent: varchar("from_agent", { length: 100 }).notNull(),
  toAgent: varchar("to_agent", { length: 100 }).notNull(),
  messageType: varchar("message_type", { length: 50 }).notNull(),
  message: text("message").notNull(),
  metadata: jsonb("metadata"),
  isRead: boolean("is_read").default(false),
  createdAt: timestamp("created_at").notNull().defaultNow()
});
// Types of messages
type MessageType =
  | 'help_request'        // Ask another agent for help
  | 'knowledge_share'     // Share learned insights
  | 'escalation'          // Escalate issue to higher agent
  | 'broadcast'           // Send to multiple agents
  | 'collaboration'       // Request collaboration
  | 'status_update'       // Report current status
  | 'error_report'        // Report error or failure
  | 'success_report';     // Report successful completion

Communication Patterns:

Pattern 1: Peer-to-Peer Help Request

// Agent #8 (Frontend) asks Agent #2 (API) for help
await agentCommunicate({
  from: 'Agent #8 (Client Framework)',
  to: 'Agent #2 (API Structure)',
  type: 'help_request',
  message: 'Need API endpoint for new housing feature. What schema should I expect?',
  metadata: {
    feature: 'housing-marketplace',
    priority: 'high',
    context: {
      currentTask: 'Building housing listing component',
      blockedOn: 'API schema definition'
    }
  }
});
// Agent #2 responds
await agentCommunicate({
  from: 'Agent #2 (API Structure)',
  to: 'Agent #8 (Client Framework)',
  type: 'help_request',
  message: 'Housing API schema: { id, title, price, location, photos[], host }',
  metadata: {
    endpoint: '/api/housing/listings',
    method: 'GET',
    responseExample: { /* ... */ }
  }
});

Pattern 2: Knowledge Broadcasting

// Agent #80 (Learning Coordinator) broadcasts insights to all agents
await agentBroadcast({
  from: 'Agent #80 (Learning Coordinator)',
  to: 'ALL_AGENTS',
  type: 'knowledge_share',
  message: 'New pattern detected: Users prefer grid view for housing listings (75% vs 25% list view)',
  metadata: {
    pattern: 'user_preference',
    data: {
      feature: 'housing',
      gridView: 75,
      listView: 25
    },
    recommendation: 'Default to grid view for housing pages'
  }
});
// Relevant agents receive and apply
// Agent #28 (Marketplace) updates default view
// Agent #8 (Frontend) adjusts UI components

Pattern 3: Escalation Chain

// Agent #23 (Event Management) escalates complex issue
await agentEscalate({
  from: 'Agent #23 (Event Management)',
  to: 'Chief #3 (Business Division)',
  type: 'escalation',
  message: 'Complex event booking conflict: User wants to book overlapping events',
  metadata: {
    issue: 'booking_conflict',
    priority: 'medium',
    context: {
      userId: 123,
      event1: 'Tango Workshop A (3pm-5pm)',
      event2: 'Tango Workshop B (4pm-6pm)',
      overlap: '4pm-5pm'
    },
    suggestedSolutions: [
      'Allow overlapping bookings with warning',
      'Block overlapping bookings entirely',
      'Suggest alternative time slots'
    ]
  }
});
// Chief #3 analyzes and decides
await agentCommunicate({
  from: 'Chief #3 (Business Division)',
  to: 'Agent #23 (Event Management)',
  type: 'escalation',
  message: 'Allow with warning. Most users manage their own schedules.',
  metadata: {
    decision: 'allow_with_warning',
    implementation: 'Show prominent warning dialog before booking'
  }
});

Pattern 4: Multi-Agent Collaboration

// Database: agentCollaborations table
export const agentCollaborations = pgTable("agent_collaborations", {
  id: serial("id").primaryKey(),
  agentId: varchar("agent_id", { length: 100 }).notNull(),
  collaboratorId: varchar("collaborator_id", { length: 100 }).notNull(),
  issue: text("issue").notNull(),
  status: varchar("status", { length: 50 }).notNull(), // 'pending', 'in_progress', 'resolved'
  resolution: text("resolution"),
  metadata: jsonb("metadata"),
  createdAt: timestamp("created_at").notNull().defaultNow(),
  resolvedAt: timestamp("resolved_at")
});
// Agent #1 (Database) + Agent #2 (API) + Agent #8 (Frontend) collaborate
const collaboration = await createCollaboration({
  agents: [
    'Agent #1 (Database Architecture)',
    'Agent #2 (API Structure)',
    'Agent #8 (Client Framework)'
  ],
  issue: 'Build new messaging system with real-time updates',
  plan: {
    agent1: 'Create messages table with WebSocket support',
    agent2: 'Build Socket.io API endpoints',
    agent8: 'Create real-time messaging UI'
  },
  coordination: {
    type: 'parallel',
    dependencies: {
      agent2: ['agent1'],  // API depends on database
      agent8: ['agent2']   // Frontend depends on API
    }
  }
});
// Agents work in coordinated parallel sequence
// Agent #1 completes â†’ Notifies Agent #2 â†’ Agent #2 starts
// Agent #2 completes â†’ Notifies Agent #8 â†’ Agent #8 starts

API Endpoints for Agent Communication:

// POST /api/agent-intelligence/messages
// Send message from one agent to another
// GET /api/agent-intelligence/messages/:agentId
// Get all messages for a specific agent
// POST /api/agent-intelligence/collaborate
// Request collaboration between agents
// GET /api/agent-intelligence/collaborations/:agentId
// Get active collaborations for an agent
// POST /api/agent-intelligence/broadcast
// Broadcast message to multiple agents
// GET /api/agent-intelligence/communications
// Get all agent communications (admin only)

2.9.5 PLATFORM-WIDE LEARNING COORDINATION
Agent #80 (Learning Coordinator) orchestrates learning across ALL 115 agents, not just within Mr. Blue team.

Learning Cycle:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 AGENT #80 LEARNING CYCLE                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1. COLLECT (from all 115 agents)                      â”‚
â”‚     â”œâ”€ Agent memories (what they learned)              â”‚
â”‚     â”œâ”€ Agent self-tests (what they can do)             â”‚
â”‚     â”œâ”€ Agent collaborations (how they helped)          â”‚
â”‚     â””â”€ User patterns (what users do)                   â”‚
â”‚                                                         â”‚
â”‚  2. ANALYZE (pattern recognition)                      â”‚
â”‚     â”œâ”€ Identify common user paths                      â”‚
â”‚     â”œâ”€ Detect inefficiencies                           â”‚
â”‚     â”œâ”€ Recognize best practices                        â”‚
â”‚     â””â”€ Spot potential issues                           â”‚
â”‚                                                         â”‚
â”‚  3. SYNTHESIZE (create insights)                       â”‚
â”‚     â”œâ”€ Generate recommendations                        â”‚
â”‚     â”œâ”€ Predict future needs                            â”‚
â”‚     â”œâ”€ Optimize workflows                              â”‚
â”‚     â””â”€ Suggest improvements                            â”‚
â”‚                                                         â”‚
â”‚  4. DISTRIBUTE (share knowledge)                       â”‚
â”‚     â”œâ”€ Broadcast to all agents                         â”‚
â”‚     â”œâ”€ Update ML models                                â”‚
â”‚     â”œâ”€ Modify agent behaviors                          â”‚
â”‚     â””â”€ Implement optimizations                         â”‚
â”‚                                                         â”‚
â”‚  5. VALIDATE (test improvements)                       â”‚
â”‚     â”œâ”€ A/B testing new behaviors                       â”‚
â”‚     â”œâ”€ Monitor user satisfaction                       â”‚
â”‚     â”œâ”€ Track performance metrics                       â”‚
â”‚     â””â”€ Rollback if needed                              â”‚
â”‚                                                         â”‚
â”‚  6. REPEAT (continuous learning)                       â”‚
â”‚     â””â”€ Every 24 hours or on-demand                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Learning Database Schema:

// agentMemories: Store what agents learn
export const agentMemories = pgTable("agent_memories", {
  id: serial("id").primaryKey(),
  agentId: varchar("agent_id", { length: 100 }).notNull(),
  memoryType: varchar("memory_type", { length: 50 }).notNull(),
  content: text("content").notNull(),
  metadata: jsonb("metadata"),
  confidence: real("confidence"),  // 0-1 (how confident agent is)
  context: jsonb("context"),
  createdAt: timestamp("created_at").notNull().defaultNow()
});
// agentKnowledge: Semantic knowledge base
export const agentKnowledge = pgTable("agent_knowledge", {
  id: serial("id").primaryKey(),
  agentId: varchar("agent_id", { length: 100 }).notNull(),
  topic: varchar("topic", { length: 255 }).notNull(),
  content: text("content").notNull(),
  embedding: vector("embedding", { dimensions: 1536 }),  // LanceDB vector
  confidence: real("confidence"),
  sourceMemoryId: integer("source_memory_id").references(() => agentMemories.id),
  tags: text("tags").array(),
  createdAt: timestamp("created_at").notNull().defaultNow(),
  updatedAt: timestamp("updated_at").notNull().defaultNow()
});
// agentLearningSessions: Track learning cycles
export const agentLearningSessions = pgTable("agent_learning_sessions", {
  id: serial("id").primaryKey(),
  agentId: varchar("agent_id", { length: 100 }).notNull(),
  sessionType: varchar("session_type", { length: 50 }).notNull(),
  startTime: timestamp("start_time").notNull(),
  endTime: timestamp("end_time"),
  outcomes: jsonb("outcomes"),
  metadata: jsonb("metadata"),
  createdAt: timestamp("created_at").notNull().defaultNow()
});

Real-World Learning Example:

Scenario: Users struggle with event creation workflow

Agent #80's Learning Process:

// 1. COLLECT
const learnings = {
  // Agent #23 (Event Management) reports
  agent23: {
    memory: 'Users abandon event creation form at "Add Location" step',
    confidence: 0.85,
    data: {
      abandonmentRate: 0.45,  // 45% drop-off
      avgTimeAtStep: 180,     // 3 minutes stuck
      commonErrors: ['Invalid address', 'Map not loading']
    }
  },
  
  // Agent #68 (Pattern Learning) detects
  agent68: {
    pattern: 'Users search for venue name instead of entering address',
    frequency: 0.72,  // 72% of users
    suggestion: 'Add venue search/autocomplete'
  },
  
  // Agent #77 (Context Provider) observes
  agent77: {
    breadcrumbs: [
      { action: 'type', target: 'input-location', value: 'La Viruta' },
      { action: 'error', error: 'Please enter a valid address' },
      { action: 'abandon', page: '/events/create' }
    ],
    userFrustration: true
  }
};
// 2. ANALYZE
const analysis = agent80.analyze(learnings);
// Returns: {
//   issue: 'Location input expects address but users want venue search',
//   impact: 'high',  // 45% abandonment
//   affectedAgents: ['Agent #23 (Events)', 'Agent #15 (Search)'],
//   suggestedFix: 'Add venue autocomplete with Nominatim API'
// }
// 3. SYNTHESIZE
const recommendation = {
  fix: 'Implement venue search autocomplete',
  implementation: {
    frontend: 'Add ComboBox with venue search',
    api: 'Use Nominatim API for venue lookup',
    database: 'Cache popular venues',
    agents: [
      'Agent #8 (Frontend) â†’ Build autocomplete UI',
      'Agent #2 (API) â†’ Add /api/venues/search endpoint',
      'Agent #15 (Search) â†’ Integrate Nominatim',
      'Agent #23 (Events) â†’ Update event creation logic'
    ]
  },
  expectedImpact: 'Reduce abandonment from 45% to <10%'
};
// 4. DISTRIBUTE
await agent80.broadcast({
  to: ['Agent #8', 'Agent #2', 'Agent #15', 'Agent #23'],
  message: recommendation,
  priority: 'high',
  deadline: '2 days'
});
// Agents build the fix in parallel
await agent80.orchestrate({
  track1: 'Agent #8 builds autocomplete UI',
  track2: 'Agent #2 + #15 build search API',
  track3: 'Agent #23 updates event logic'
});
// 5. VALIDATE
const results = await agent80.validateImprovement({
  metric: 'event_creation_abandonment',
  before: 0.45,
  after: 0.08,  // 8% abandonment (47% improvement!)
  duration: '7 days'
});
// 6. LEARN
await agent80.recordLearning({
  lesson: 'Users prefer venue search over manual address entry',
  context: 'event_creation',
  solution: 'autocomplete_with_popular_venues',
  effectiveness: 0.47,  // 47% improvement
  applyTo: ['all_location_inputs']  // Apply pattern elsewhere
});

Learning Distribution:

// Agent #80 shares this learning with other location-based features
await agent80.broadcast({
  to: ['Agent #28 (Marketplace)', 'Agent #29 (Housing)', 'Agent #22 (Groups)'],
  message: {
    pattern: 'users_prefer_venue_search',
    implementation: 'autocomplete_with_nominatim',
    effectiveness: 0.47,
    recommendation: 'Apply to all address inputs'
  }
});
// Agents automatically implement in their features
// Agent #28 adds venue search to marketplace listings
// Agent #29 adds it to housing location input
// Agent #22 adds it to group location selection

2.9.6 COMPLETE AGENT INTELLIGENCE NETWORK ARCHITECTURE
The Agent Intelligence Network enables all 115 agents to autonomously learn, test, collaborate, and improve.

9 Database Tables:

// 1. agentMemories - What agents learn
// 2. agentKnowledge - Semantic knowledge base (with vector embeddings)
// 3. agentSelfTests - Self-testing results
// 4. componentAgents - Registry of component agents
// 5. agentCommunications - Agent-to-agent messages
// 6. agentCollaborations - Peer collaboration tracking
// 7. agentEscalations - Issues escalated to higher agents
// 8. agentLearningSessions - Learning cycle tracking
// 9. agentChangeBroadcasts - Platform-wide change notifications

20 API Endpoints:

// Memory Operations
POST   /api/agent-intelligence/memories
GET    /api/agent-intelligence/memories/:agentId
GET    /api/agent-intelligence/memories/search
// Self-Testing
POST   /api/agent-intelligence/tests/execute
GET    /api/agent-intelligence/tests/results/:agentId
GET    /api/agent-intelligence/tests/recent
GET    /api/agent-intelligence/stats
// Collaboration
POST   /api/agent-intelligence/collaborate
GET    /api/agent-intelligence/collaborations/:agentId
GET    /api/agent-intelligence/collaborations/recent
PATCH  /api/agent-intelligence/collaborations/:id/resolve
// Communication
POST   /api/agent-intelligence/messages
GET    /api/agent-intelligence/messages/:agentId
GET    /api/agent-intelligence/communications
PATCH  /api/agent-intelligence/messages/:id/read
// Escalation
POST   /api/agent-intelligence/escalate
GET    /api/agent-intelligence/escalations/:agentId
PATCH  /api/agent-intelligence/escalations/:id/resolve
// System
GET    /api/agent-intelligence/activities
POST   /api/agent-intelligence/broadcast
GET    /api/agent-intelligence/agents/:id/health

7 Core Services:

// Track A: Learning & Memory
1. AgentMemoryService (350 lines)
   - Store/retrieve memories
   - Semantic search with LanceDB
   - Confidence tracking
2. AgentSelfTestFramework (400 lines)
   - Execute capability tests
   - Health score calculation
   - Auto-test scheduling
// Track B: Collaboration & Escalation
3. AgentCollaborationService (320 lines)
   - Peer-to-peer help requests
   - Collaboration tracking
   - Resolution logging
4. AgentEscalationService (280 lines)
   - Smart escalation to higher agents
   - Priority queue management
   - Resolution tracking
// Track C: Mr. Blue Coordination
5. MrBlueCoordinator (350 lines)
   - Central orchestration hub
   - Broadcast change notifications
   - Multi-agent task coordination
6. ChangeBroadcastService (200 lines)
   - Push updates to affected agents
   - Track propagation status
   - Retry mechanisms
// Track D: Base Infrastructure
7. ComponentAgent (200 lines)
   - Base class for all component agents
   - Standard capabilities interface
   - Health monitoring

Intelligence Dashboard (/admin/agent-intelligence):

Real-time Updates: Auto-refresh every 3 seconds
5 Interactive Tabs:
Overview - Recent agent activity feed
Communications - Agent-to-agent messages
Tests - Self-test results with pass/fail status
Collaborations - Peer collaboration tracking
Learning - Knowledge base and capabilities
Stats Dashboard:
Total Agents (active/learning breakdown)
Self-Tests (pass rate, total tests)
Communications (unread count)
Health Score (system-wide average)
Agent Autonomous Intelligence Cycle:

Every agent (all 115) follows this cycle:
1. LEARN     â†’ Store experiences in memory
2. SELF-TEST â†’ Validate capabilities
3. ANALYZE   â†’ Review test results
4. COLLABORATE â†’ Ask peers if needed
5. BUILD     â†’ Apply improvements
6. TEST      â†’ Verify improvements
7. REPORT    â†’ Log results & health
8. REPEAT    â†’ Continuous cycle

3. INTEGRATION & WORKFLOWS
3.1 Visual Editor + Mr. Blue Chat Layout
Split-Pane Interface:

Left 60%: Live preview iframe with editable elements
Right 40%: Mr. Blue AI chat panel
Mr. Blue's Awareness in Visual Editor:

// Mr. Blue knows in real-time:
{
  currentPage: "/memories",
  visualEditorActive: true,
  selectedElement: {
    testId: "button-create-memory",
    tagName: "BUTTON",
    textContent: "Create Memory",
    className: "bg-blue-600 text-white px-4 py-2 rounded-lg",
    filePath: "client/src/pages/MemoriesPage.tsx",
    lineNumber: 45,
    props: {
      onClick: "handleCreateMemory",
      disabled: false
    }
  },
  recentEdits: [
    {
      timestamp: "2025-11-03T10:45:00Z",
      change: "Changed button color from blue-600 to teal-600",
      component: "button-create-memory",
      type: "style"
    },
    {
      timestamp: "2025-11-03T10:46:30Z",
      change: "Increased padding from px-4 py-2 to px-6 py-3",
      component: "button-create-memory",
      type: "size"
    }
  ],
  userIntent: "designing",  // AI-detected intent
  suggestedActions: [
    "Make text larger for better readability",
    "Add icon to button for visual clarity",
    "Ensure color contrast meets WCAG AA standards"
  ]
}

3.2 Conversational Editing Workflow
Like Replit Agent - You Can Chat to Edit Pages

Example Conversation 1:

USER: "Make this button more prominent"
MR. BLUE: "I'll make the 'Create Memory' button stand out more. I recommend:
- Increase size to 'lg' (px-6 py-3)
- Use high-contrast color (teal-600)
- Add subtle shadow for depth
- Make font weight bold
Should I apply these changes?"
USER: "Yes"
MR. BLUE: "Great! Making changes now...
âœ… Updated button styling
âœ… Generated code with GPT-4o
âœ… Created Git branch: visual-edit-2025-11-03
âœ… Preview URL ready: https://preview.mundotango.com/visual-edit-2025-11-03
Want me to deploy to production?"

Example Conversation 2:

USER: "The heading looks too small on mobile"
MR. BLUE: "I see you're looking at the 'Welcome to Memories' heading. 
Currently it's text-3xl on all screens.
I can make it responsive:
- Mobile: text-2xl
- Tablet: text-3xl
- Desktop: text-4xl
Should I update it?"
USER: "Yes, and make it centered"
MR. BLUE: "Perfect! Changes:
1. Responsive text sizing
2. Text alignment: center
3. Added mobile optimization
Applying now... Done! âœ…
Preview: https://preview.mundotango.com/visual-edit-2025-11-03
The heading now scales beautifully across all devices."

Example Conversation 3:

USER: "Can you help me redesign this whole section?"
MR. BLUE: "Absolutely! I'm looking at the 'Create Memory' section.
Current layout:
- Button at top
- Form below
- Images at bottom
I can suggest:
A) Modern card layout with centered form
B) Two-column layout (form left, preview right)
C) Step-by-step wizard with progress indicator
Which direction interests you?"
USER: "Option B sounds good"
MR. BLUE: "Great choice! Two-column layout coming up.
Changes I'll make:
1. Split into flexbox grid (50/50)
2. Form on left with better spacing
3. Live preview on right
4. Add upload area with drag-drop
5. Mobile: Stack vertically
This is a bigger change. I'll create a preview first.
Generating code... Done! âœ…
Preview URL: https://preview.mundotango.com/visual-edit-2025-11-03
Check it out and let me know what you think!"

3.3 Save â†’ Confirm â†’ Build Orchestration
Complete Workflow:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER: Makes changes in Visual Editor                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VISUAL EDITOR TRACKER: Records all changes             â”‚
â”‚  â€¢ Text edits                                           â”‚
â”‚  â€¢ Style changes                                        â”‚
â”‚  â€¢ Layout modifications                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MR. BLUE: Summarizes changes                           â”‚
â”‚  "You changed:                                          â”‚
â”‚   - Button color (blue â†’ teal)                          â”‚
â”‚   - Button size (increased padding)                     â”‚
â”‚   - Added shadow for depth"                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER: Confirms "Yes, apply these changes"              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AGENT #79 (Quality Validator): Pre-work checks         â”‚
â”‚  âœ“ All required data-testid present                     â”‚
â”‚  âœ“ No accessibility violations                          â”‚
â”‚  âœ“ Color contrast meets WCAG AA                         â”‚
â”‚  âœ“ Responsive design maintained                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AGENT #78 (Visual Editor): Generate code               â”‚
â”‚  â€¢ Sends changes to OpenAI GPT-4o                       â”‚
â”‚  â€¢ Receives production-ready React/Tailwind code        â”‚
â”‚  â€¢ Shows code preview to user                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AGENT #76 (Replit Architecture): Apply code            â”‚
â”‚  â€¢ Create Git branch                                    â”‚
â”‚  â€¢ Backup original files                                â”‚
â”‚  â€¢ Write new code                                       â”‚
â”‚  â€¢ Commit with descriptive message                      â”‚
â”‚  â€¢ Push to remote                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PREVIEW DEPLOYMENT:                                    â”‚
â”‚  â€¢ Build staging version                                â”‚
â”‚  â€¢ Generate shareable URL (24-hour validity)            â”‚
â”‚  â€¢ Run automated tests                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MR. BLUE: Shares preview link                          â”‚
â”‚  "Preview ready! https://preview.mundotango.com/..."    â”‚
â”‚  "All tests passed âœ…"                                   â”‚
â”‚  "Ready to deploy to production?"                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER: Confirms "Yes, deploy to production"             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GITHUB PR CREATION:                                    â”‚
â”‚  â€¢ Create pull request                                  â”‚
â”‚  â€¢ Run Playwright tests                                 â”‚
â”‚  â€¢ If all pass: Auto-merge                              â”‚
â”‚  â€¢ If any fail: Block & notify                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PRODUCTION DEPLOYMENT:                                 â”‚
â”‚  â€¢ Merge to main branch                                 â”‚
â”‚  â€¢ Trigger production build                             â”‚
â”‚  â€¢ Deploy to live platform                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MR. BLUE: Confirms deployment                          â”‚
â”‚  "âœ… Changes live on production!"                        â”‚
â”‚  "Users will see the new design immediately."           â”‚
â”‚                                                         â”‚
â”‚  AGENT #80: Records learning                            â”‚
â”‚  â€¢ Pattern: User prefers teal buttons                   â”‚
â”‚  â€¢ Share with other components                          â”‚
â”‚  â€¢ Update design system recommendations                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. TECHNICAL IMPLEMENTATION
4.1 Files & Components
Visual Editor Files:

client/src/components/visual-editor/
â”œâ”€â”€ VisualEditorOverlay.tsx         # Main container
â”œâ”€â”€ ComponentSelector.tsx           # Click-to-select logic
â”œâ”€â”€ DragDropHandler.tsx             # Drag & drop UX
â”œâ”€â”€ EditControls.tsx                # 4-tab edit panel
â”‚   â”œâ”€â”€ PositionTab.tsx
â”‚   â”œâ”€â”€ SizeTab.tsx
â”‚   â”œâ”€â”€ StyleTab.tsx
â”‚   â””â”€â”€ TextTab.tsx
â”œâ”€â”€ VisualEditorTracker.ts          # Change tracking
â”œâ”€â”€ CodePreview.tsx                 # Before/after code diff
â””â”€â”€ MrBlueVisualChat.tsx            # AI chat panel

Mr. Blue Files:

client/src/components/mrBlue/
â”œâ”€â”€ MrBlueChat.tsx                  # Main chat interface
â”œâ”€â”€ MrBlueAvatar.tsx                # 3D avatar (React Three Fiber)
â”œâ”€â”€ MrBlueFloatingButton.tsx        # Floating AI button
â””â”€â”€ MrBlueTour.tsx                  # Interactive tours
client/src/lib/mrBlue/
â”œâ”€â”€ breadcrumbTracker.ts            # Breadcrumb tracking
â”œâ”€â”€ failedActionMonitor.ts          # Error monitoring
â”œâ”€â”€ mlPatternRecognition.ts         # ML models
â”œâ”€â”€ contextPreservation.ts          # Cross-page context
â””â”€â”€ learningCoordinator.ts          # Agent #80 logic

Backend Files:

server/routes/
â”œâ”€â”€ visualEditor.ts                 # Visual Editor API
â”œâ”€â”€ mrBlueRoutes.ts                 # Mr. Blue API
â”œâ”€â”€ breadcrumbRoutes.ts             # Breadcrumb tracking API
â””â”€â”€ learningRoutes.ts               # ML learning API
server/services/
â”œâ”€â”€ gitService.ts                   # Git automation
â”œâ”€â”€ aiCodeGenerator.ts              # OpenAI integration
â”œâ”€â”€ deploymentService.ts            # Preview/prod deployment
â””â”€â”€ mlTrainingService.ts            # ML model training

5. DATABASE SCHEMA
Breadcrumbs Table:

export const breadcrumbs = pgTable("breadcrumbs", {
  id: serial("id").primaryKey(),
  userId: integer("user_id").notNull().references(() => users.id),
  sessionId: varchar("session_id", { length: 255 }).notNull(),
  timestamp: timestamp("timestamp").notNull().defaultNow(),
  
  // Page context
  page: varchar("page", { length: 500 }).notNull(),
  pageTitle: varchar("page_title", { length: 255 }),
  referrer: varchar("referrer", { length: 500 }),
  
  // Action context
  action: varchar("action", { length: 50 }).notNull(), // 'click', 'view', 'input', 'submit', 'error', 'navigation'
  target: varchar("target", { length: 500 }),
  targetId: varchar("target_id", { length: 255 }),
  value: jsonb("value"),
  
  // User context
  userJourney: varchar("user_journey", { length: 50 }),
  userRole: varchar("user_role", { length: 50 }),
  userIntent: varchar("user_intent", { length: 255 }),
  
  // Outcome
  success: boolean("success").default(true),
  error: text("error"),
  duration: integer("duration"), // milliseconds
  
  // ML predictions
  prediction: varchar("prediction", { length: 255 }),
  confidence: real("confidence"),
  patternId: varchar("pattern_id", { length: 100 }),
  
  createdAt: timestamp("created_at").notNull().defaultNow()
}, (table) => ({
  idxUserId: index("idx_breadcrumbs_user").on(table.userId),
  idxSession: index("idx_breadcrumbs_session").on(table.sessionId),
  idxTimestamp: index("idx_breadcrumbs_timestamp").on(table.timestamp),
  idxAction: index("idx_breadcrumbs_action").on(table.action)
}));

Failed Actions Table:

export const failedActions = pgTable("failed_actions", {
  id: serial("id").primaryKey(),
  breadcrumbId: integer("breadcrumb_id").references(() => breadcrumbs.id),
  userId: integer("user_id").notNull().references(() => users.id),
  sessionId: varchar("session_id", { length: 255 }).notNull(),
  timestamp: timestamp("timestamp").notNull().defaultNow(),
  
  // Failure details
  failureType: varchar("failure_type", { length: 50 }).notNull(), // '404', 'api_error', 'validation', etc.
  statusCode: integer("status_code"),
  errorDetails: jsonb("error_details").notNull(),
  
  // Recovery
  recoveryAttempted: boolean("recovery_attempted").default(false),
  recoverySuccessful: boolean("recovery_successful").default(false),
  retries: integer("retries").default(0),
  
  // Resolution
  resolved: boolean("resolved").default(false),
  resolvedAt: timestamp("resolved_at"),
  resolvedBy: integer("resolved_by").references(() => users.id),
  
  createdAt: timestamp("created_at").notNull().defaultNow()
}, (table) => ({
  idxUserId: index("idx_failed_actions_user").on(table.userId),
  idxFailureType: index("idx_failed_actions_type").on(table.failureType),
  idxResolved: index("idx_failed_actions_resolved").on(table.resolved)
}));

User Patterns Table:

export const userPatterns = pgTable("user_patterns", {
  id: serial("id").primaryKey(),
  userId: integer("user_id").notNull().references(() => users.id),
  patternId: varchar("pattern_id", { length: 100 }).notNull(),
  journey: varchar("journey", { length: 50 }),
  
  // Pattern data
  commonSequences: jsonb("common_sequences").notNull(),
  timePatterns: jsonb("time_patterns"),
  preferredFeatures: jsonb("preferred_features"),
  avoidedFeatures: jsonb("avoided_features"),
  expertiseLevel: varchar("expertise_level", { length: 50 }),
  
  // Predictions
  nextActions: jsonb("next_actions"),
  
  // Metadata
  confidence: real("confidence"),
  sampleSize: integer("sample_size"),
  lastUpdated: timestamp("last_updated").notNull().defaultNow(),
  createdAt: timestamp("created_at").notNull().defaultNow()
}, (table) => ({
  idxUserId: index("idx_user_patterns_user").on(table.userId),
  idxJourney: index("idx_user_patterns_journey").on(table.journey)
}));

Visual Edits Table:

export const visualEdits = pgTable("visual_edits", {
  id: serial("id").primaryKey(),
  userId: integer("user_id").notNull().references(() => users.id),
  sessionId: varchar("session_id", { length: 255 }).notNull(),
  
  // Page context
  page: varchar("page", { length: 500 }).notNull(),
  componentId: varchar("component_id", { length: 255 }).notNull(),
  
  // Change details
  changeType: varchar("change_type", { length: 50 }).notNull(), // 'text', 'style', 'layout', 'size'
  before: jsonb("before"),
  after: jsonb("after"),
  
  // Code generation
  generatedCode: text("generated_code"),
  aiModel: varchar("ai_model", { length: 50 }),
  
  // Git info
  gitBranch: varchar("git_branch", { length: 255 }),
  commitHash: varchar("commit_hash", { length: 255 }),
  
  // Deployment
  previewUrl: varchar("preview_url", { length: 500 }),
  deployedToProduction: boolean("deployed_to_production").default(false),
  deployedAt: timestamp("deployed_at"),
  
  createdAt: timestamp("created_at").notNull().defaultNow()
}, (table) => ({
  idxUserId: index("idx_visual_edits_user").on(table.userId),
  idxPage: index("idx_visual_edits_page").on(table.page),
  idxDeployed: index("idx_visual_edits_deployed").on(table.deployedToProduction)
}));

6. API ENDPOINTS
Visual Editor APIs:

// Get file content for editing
GET /api/visual-editor/file-content
Query: { filePath: string }
Response: { content: string, language: string }
// Generate code from visual changes
POST /api/visual-editor/generate-code
Body: { changes: VisualEdit[], currentCode: string }
Response: { updatedCode: string, explanation: string, affectedFiles: string[] }
// Save changes to Git
POST /api/visual-editor/save
Body: { filePath: string, newCode: string, message: string }
Response: { branch: string, commitHash: string }
// Deploy preview
POST /api/visual-editor/preview
Body: { branch: string }
Response: { previewUrl: string, expiresAt: Date }
// Deploy to production
POST /api/visual-editor/deploy
Body: { branch: string }
Response: { prUrl: string, mergeStatus: string }

Mr. Blue APIs:

// Chat with Mr. Blue
POST /api/mrblue/chat
Body: { message: string, pageContext: PageContext }
Response: { response: string, suggestions: string[], actions: Action[] }
// Get page context
GET /api/mrblue/context
Response: { page: string, elements: Element[], breadcrumbs: Breadcrumb[] }
// Track breadcrumb
POST /api/breadcrumbs
Body: Breadcrumb
Response: { id: string, success: boolean }
// Get user breadcrumbs
GET /api/breadcrumbs
Query: { userId: number, limit: number }
Response: { breadcrumbs: Breadcrumb[] }
// Log failed action
POST /api/failed-actions
Body: FailedAction
Response: { id: string, assistance: MrBlueAssistance }
// Get ML predictions
GET /api/ml/predictions
Query: { userId: number }
Response: { nextActions: Prediction[], confidence: number }

7. SECURITY & ACCESS CONTROL
Visual Editor Access:

// Only Super Admins can access
if (user?.role !== 'super_admin') {
  return null; // Hide Visual Editor
}
// File access restricted to client/src
const clientSrcPath = path.resolve(process.cwd(), 'client/src');
if (!fullPath.startsWith(clientSrcPath)) {
  throw new Error('Access denied: Can only read files from client/src');
}
// Git operations validated
const branchName = description.replace(/[^a-z0-9-]/gi, '-');

Mr. Blue Access:

All users can access Mr. Blue chat
Context data scoped to user's own actions
No cross-user data leakage
Breadcrumbs and patterns are user-specific
8. FILE STRUCTURE
mundo-tango-platform/
â”œâ”€â”€ client/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ visual-editor/
â”‚       â”‚   â”‚   â”œâ”€â”€ VisualEditorOverlay.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ ComponentSelector.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ DragDropHandler.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ EditControls.tsx
â”‚       â”‚   â”‚   â”œâ”€â”€ VisualEditorTracker.ts
â”‚       â”‚   â”‚   â””â”€â”€ MrBlueVisualChat.tsx
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ mrBlue/
â”‚       â”‚       â”œâ”€â”€ MrBlueChat.tsx
â”‚       â”‚       â”œâ”€â”€ MrBlueAvatar.tsx
â”‚       â”‚       â”œâ”€â”€ MrBlueFloatingButton.tsx
â”‚       â”‚       â””â”€â”€ MrBlueTour.tsx
â”‚       â”‚
â”‚       â””â”€â”€ lib/
â”‚           â””â”€â”€ mrBlue/
â”‚               â”œâ”€â”€ breadcrumbTracker.ts
â”‚               â”œâ”€â”€ failedActionMonitor.ts
â”‚               â”œâ”€â”€ mlPatternRecognition.ts
â”‚               â”œâ”€â”€ contextPreservation.ts
â”‚               â””â”€â”€ learningCoordinator.ts
â”‚
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ visualEditor.ts
â”‚   â”‚   â”œâ”€â”€ mrBlueRoutes.ts
â”‚   â”‚   â”œâ”€â”€ breadcrumbRoutes.ts
â”‚   â”‚   â””â”€â”€ learningRoutes.ts
â”‚   â”‚
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ gitService.ts
â”‚       â”œâ”€â”€ aiCodeGenerator.ts
â”‚       â”œâ”€â”€ deploymentService.ts
â”‚       â””â”€â”€ mlTrainingService.ts
â”‚
â”œâ”€â”€ shared/
â”‚   â””â”€â”€ schema.ts          # Database schema (Drizzle ORM)
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ visual-editor/
    â”‚   â””â”€â”€ USER_GUIDE.md
    â”‚
    â””â”€â”€ mr-blue/
        â””â”€â”€ INTELLIGENCE_ARCHITECTURE.md

âœ… HANDOFF COMPLETE
This document contains EVERYTHING built for Visual Editor and Mr. Blue in the 10-21-2025 branch. Any developer or AI agent can use this to understand the complete system and build upon it.

Next Steps: Create Playwright tests to validate all features documented above.

Generated: November 3, 2025
Methodology: MB.MD (Simultaneously, Recursively, Critically)
Status: âœ… COMPLETE - ZERO-KNOWLEDGE HANDOFF READY